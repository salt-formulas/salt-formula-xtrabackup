
{% set client = salt['grains.filter_by']({
  'Debian': {
    'pkgs': ['percona-xtrabackup'],
    'cron': True,
    'backup_dir': '/var/backups/mysql/xtrabackup'
  },
  'RedHat': {
    'pkgs': ['percona-xtrabackup'],
    'cron': True,
    'backup_dir': '/var/backups/mysql/xtrabackup'
  },
}, merge=salt['pillar.get']('xtrabackup:client')) %}

{% set server = salt['grains.filter_by']({
  'Debian': {
    'pkgs': ['rsync'],
    'cron': True,
    'restrict_clients': True,
    'backup_dir': '/var/backups/mysql/xtrabackup'
  },
  'RedHat': {
    'pkgs': ['rsync'],
    'cron': True,
    'restrict_clients': True,
    'backup_dir': '/var/backups/mysql/xtrabackup'
  },
}, merge=salt['pillar.get']('xtrabackup:server')) %}
